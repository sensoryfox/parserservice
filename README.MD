# üöÄ –°–µ—Ä–≤–∏—Å –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ `doc-parser`

[![–°—Ç–∞—Ç—É—Å —Å–±–æ—Ä–∫–∏](https://img.shields.io/badge/build-passing-brightgreen)](https://github.com)
[![–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏](https://img.shields.io/badge/coverage-85%25-blue)](https://github.com)
[![–õ–∏—Ü–µ–Ω–∑–∏—è](https://img.shields.io/badge/license-Custom-lightgrey)](./#%EF%B8%8F-–ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-–∫–ª—é—á–µ–≤—ã–µ-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)

–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ —Ñ–∞–π–ª –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ª—é–±–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ (`PDF`, `DOCX`, `XLSX`, –∫–æ–¥, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è), —Ä–∞–∑–±–∏—Ä–∞–µ—Ç –µ–≥–æ –Ω–∞ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞.

–°–µ—Ä–≤–∏—Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á —á–µ—Ä–µ–∑ Redis –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

## üéØ –ú–∏—Å—Å–∏—è –∏ –∫–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

**–ú–∏—Å—Å–∏—è:** –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ —Ä–∞–∑–º–µ—Ç–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è —á–∏—Å—Ç—ã–π, –ø–æ—Å—Ç—Ä–æ—á–Ω—ã–π `Markdown` –∏ –ø–æ–¥—Ä–æ–±–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—É—é –∫–∞—Ä—Ç—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –µ–≥–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞.

**–ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
*   **–ú—É–ª—å—Ç–∏—Ñ–æ—Ä–º–∞—Ç–Ω–æ—Å—Ç—å:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `PDF`, `DOCX`, `PPTX`, `XLSX`, `TXT`, –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ (`.py`, `.js` –∏ –¥—Ä.) –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
*   **–ì–ª—É–±–æ–∫–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞:** –ö–∞–∂–¥—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–æ–∫–∏, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –∏–º–µ–µ—Ç —Ç–∏–ø (`–∑–∞–≥–æ–ª–æ–≤–æ–∫`, `–ø–∞—Ä–∞–≥—Ä–∞—Ñ`, `—Ç–∞–±–ª–∏—Ü–∞`, `–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ`, `—ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞`, `–±–ª–æ–∫ –∫–æ–¥–∞`).
*   **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (MinIO).
*   **LLM-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω—é—é LLM –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π (alt-text) –¥–ª—è –≤—Å–µ—Ö –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
*   **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –ü–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ FastAPI –∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.
*   **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞:** –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –æ—Ç –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ –æ—á–µ—Ä–µ–¥—å –¥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–ª–∏ –æ—à–∏–±–∫–∏.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –º–µ—Å—Ç–æ –≤ —Å–∏—Å—Ç–µ–º–µ

`doc-parser` —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º **stateless** —Å–µ—Ä–≤–∏—Å–æ–º. –û–Ω –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –æ —Ç–æ–º, *—á—Ç–æ* –ø–∞—Ä—Å–∏—Ç—å, –∞ —Ç–æ–ª—å–∫–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –µ–º—É –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –≤—ã—à–µ—Å—Ç–æ—è—â–∏–π —Å–µ—Ä–≤–∏—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `search-api`).

**–ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
1.  **–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å (`search-api`)** –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–∞–π–ª –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ raw-–≤–µ—Ä—Å–∏—é –≤ MinIO –∏ —Å—Ç–∞–≤–∏—Ç –∑–∞–¥–∞—á—É –Ω–∞ –ø–∞—Ä—Å–∏–Ω–≥ –≤ –æ—á–µ—Ä–µ–¥—å (Redis).
2.  **RQ-–≤–æ—Ä–∫–µ—Ä** (–ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–π `search-api`) –∑–∞–±–∏—Ä–∞–µ—Ç –∑–∞–¥–∞—á—É –∏–∑ –æ—á–µ—Ä–µ–¥–∏.
3.  –í–æ—Ä–∫–µ—Ä –¥–µ–ª–∞–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å `POST /parse/{doc_id}` –∫ —Å–µ—Ä–≤–∏—Å—É `doc-parser`.
4.  **`doc-parser`** –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å—é —Ç—è–∂–µ–ª—É—é —Ä–∞–±–æ—Ç—É:
    *   –°–∫–∞—á–∏–≤–∞–µ—Ç raw-—Ñ–∞–π–ª –∏–∑ MinIO.
    *   –í—ã–±–∏—Ä–∞–µ—Ç –Ω—É–∂–Ω—ã–π –ø–∞—Ä—Å–µ—Ä (`marker-pdf`, `python-docx` –∏ —Ç.–¥.) –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.
    *   –†–∞–∑–±–∏—Ä–∞–µ—Ç —Ñ–∞–π–ª –Ω–∞ —Å—Ç—Ä–æ–∫–∏ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
    *   (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ LLM –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω–∏–π.
    *   –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç: —Å—Ç—Ä–æ–∫–∏ –≤ **PostgreSQL**, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ **MinIO**.
5.  –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–±–æ—Ç—ã `doc-parser` –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç **—Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ –≤ Redis**.

## ‚öôÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç: –°—Ç–∞–¥–∏–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞

–ö–∞–∂–¥—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —á–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å—Ç–∞–¥–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ API —Å—Ç–∞—Ç—É—Å–∞:

1.  `QUEUED` ‚Äî –ó–∞–¥–∞—á–∞ –ø—Ä–∏–Ω—è—Ç–∞ –∏ –æ–∂–∏–¥–∞–µ—Ç –Ω–∞—á–∞–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏.
2.  `DOWNLOADING` ‚Äî –ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –∏–∑ MinIO.
3.  `PARSING` ‚Äî –û—Å–Ω–æ–≤–Ω–∞—è, —Å–∞–º–∞—è —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–∞—è —Å—Ç–∞–¥–∏—è. –†–∞–±–æ—Ç–∞–µ—Ç `marker-pdf` –∏–ª–∏ –¥—Ä—É–≥–æ–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø–∞—Ä—Å–µ—Ä.
4.  `ANALYZING_IMAGES` ‚Äî –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ LLM –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–ø–∏—Å–∞–Ω–∏–π.
5.  `SAVING` ‚Äî –†–∞–∑–æ–±—Ä–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ PostgreSQL –∏ MinIO.
6.  `SUCCESS` / `FAILURE` ‚Äî –§–∏–Ω–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –∑–∞–¥–∞—á–∏.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Docker)

–ó–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –∏ –µ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.

1.  **–°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
git clone <your-repo-url>
    cd doc-parser
2.  **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
    –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä `.env.example` –≤ `.env` –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Ö–æ—Ç—è –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–¥—Ö–æ–¥—è—Ç).
cp .env.example .env
3.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker Compose:**
    –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Å–æ–±–µ—Ä–µ—Ç –æ–±—Ä–∞–∑ `doc-parser`, –ø–æ–¥–Ω–∏–º–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å PostgreSQL –∏ Redis –∏ –∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–∏—Å.
docker-compose up --build
4.  **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å:**
    –°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:8000`. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ–≥–æ "–∑–¥–æ—Ä–æ–≤—å–µ" –º–æ–∂–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π:
curl http://localhost:8000/healthz
    # –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: {"status":"ok"}
## üõ†Ô∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–µ—Ä–≤–∏—Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Ñ–∞–π–ª `.env`).
| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| ------------------- | --------------------------------------------------------------------- | ------------------------- |
| `PG_HOST` | –•–æ—Å—Ç PostgreSQL. | `postgres` |
| `PG_USER` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å PostgreSQL. | `user` |
| `PG_PASSWORD` | –ü–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è PostgreSQL. | `password` |
| `PG_DB` | –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. | `search_db` |
| `MINIO_ENDPOINT` | –ê–¥—Ä–µ—Å MinIO (S3) API. | `minio:9000` |
| `MINIO_ACCESS_KEY` | –ö–ª—é—á –¥–æ—Å—Ç—É–ø–∞ –∫ MinIO. | `minio` |
| `MINIO_SECRET_KEY` | –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –∫ MinIO. | `minio123` |
| `LLM_IMAGE_API_URL` | URL —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω, LLM –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è. | `null` |
| `LLM_IMAGE_API_KEY` | API-–∫–ª—é—á –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ LLM. | `null` |
| `REDIS_URL` | URL –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis. | `redis://redis:6379/0` |
| `TORCH_DEVICE` | –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è PyTorch (`cpu`, `cuda`). | `cpu` |
## üîå API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞

-   **`POST /parse/{doc_id}`**
-   –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (`ParseRequest`):**
{
  "file_name": "annual-report-2023.pdf",
  "parse_images": true
}
**–û—Ç–≤–µ—Ç (`202 Accepted`):**
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞—á–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏.
{
  "doc_id": "a1b2c3d4-e5f6-a7b8-c9d0-e1f2a3b4c5d6",
  "status": "PENDING",
  "stage": "QUEUED",
  "progress": 0.0,
  "error": null,
  "result": null
}
### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏

-   **`GET /parse/status/{doc_id}`**
-   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏.

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ):**
{
  "doc_id": "a1b2c3d4-e5f6-a7b8-c9d0-e1f2a3b4c5d6",
  "status": "IN_PROGRESS",
  "stage": "PARSING",
  "progress": 0.5,
  "error": null,
  "result": null
}
**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (—É—Å–ø–µ—Ö):**
{
  "doc_id": "a1b2c3d4-e5f6-a7b8-c9d0-e1f2a3b4c5d6",
  "status": "SUCCESS",
  "stage": "SUCCESS",
  "progress": 1.0,
  "error": null,
  "result": {
    "lines_count": 452,
    "images_count": 12
  }
}
### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

-   **`GET /healthz`**
-   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{"status": "ok"}`, –µ—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω.

## üêç –ö–ª–∏–µ–Ω—Ç –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

–î–ª—è —É–¥–æ–±–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–µ—Ä–≤–∏—Å–æ–º `doc-parser` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç `DocParserClient`. –û–Ω –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç –ª–æ–≥–∏–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ–∂–∏–¥–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
import asyncio
from uuid import uuid4
from parser_client import DocParserClient, DocParserError

async def main():
    DOC_ID = uuid4()
    FILE_NAME = "my-document.docx"
    PARSER_URL = "http://localhost:8000"

    # –í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ –≤ MinIO
    # await data_client.put_object(f"{DOC_ID}/raw/{FILE_NAME}", file_bytes)

    client = DocParserClient(base_url=PARSER_URL)
    try:
        # –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ –∏ –∂–¥–µ—Ç –µ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, –ø–µ—á–∞—Ç–∞—è –ø—Ä–æ–≥—Ä–µ—Å—Å
        result = await client.parse_and_wait(
            doc_id=DOC_ID,
            file_name=FILE_NAME,
            parse_images=True
        )
        print("\n--- –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ---")
        print(result)
    except DocParserError as e:
        print(f"\n--- –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ --- \n{e}")
    except asyncio.TimeoutError:
        print("\n--- –û—à–∏–±–∫–∞ --- \n–û–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–≤—ã—Å–∏–ª–∞ —Ç–∞–π–º-–∞—É—Ç.")

if __name__ == "__main__":
    asyncio.run(main())
**–í—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª–∏:**
Client: Polling status for ... [  0%] PENDING | Stage: QUEUED
Client: Polling status for ... [ 25%] IN_PROGRESS | Stage: DOWNLOADING
Client: Polling status for ... [ 50%] IN_PROGRESS | Stage: PARSING
Client: Polling status for ... [ 75%] IN_PROGRESS | Stage: ANALYZING_IMAGES
Client: Polling status for ... [100%] SUCCESS | Stage: SUCCESS
Client: Parsing for ... completed successfully.

--- –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ---
{'lines_count': 452, 'images_count': 12}
## üß© –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –Ω–æ–≤—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ñ–∞–π–ª–æ–≤.

1.  **–°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å –ø–∞—Ä—Å–µ—Ä–∞** –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `src/parsers/`, —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–≤ –µ–≥–æ –æ—Ç `BaseParser`.
# src/parsers/my_format_parser.py
    from .base import BaseParser
    from ..models import ParseResult

    class MyFormatParser(BaseParser):
        async def parse(self, ...) -> ParseResult:
            # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∑–¥–µ—Å—å
            ...
            return ParseResult(lines=..., images=...)
2.  **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –µ–≥–æ** –≤ `OrchestratorService` –≤ —Ñ–∞–π–ª–µ `src/services/orchestrator.py`:
# src/services/orchestrator.py
    class OrchestratorService:
        def _register_parsers(self):
            return {
                ...
                ".myformat": MyFormatParser(),
                ...
            }
## ‚öñÔ∏è –õ–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∫–ª—é—á–µ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–°–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É `marker-pdf` –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å PDF –∏ –æ—Ñ–∏—Å–Ω—ã–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏. **–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –µ–µ —É—Å–ª–æ–≤–∏—è –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏—è:**

> –ú–æ–¥–µ–ª–∏ `marker-pdf` –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–¥ `cc-by-nc-sa-4.0`. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–Ω–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏ –ª–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
>
> **–ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ª–∏—Ü–µ–Ω–∑–∏–∏ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π —Å –≥–æ–¥–æ–≤—ã–º –¥–æ—Ö–æ–¥–æ–º **–º–µ–Ω–µ–µ $2 –º–ª–Ω USD** –∏ –æ–±—â–∏–º –æ–±—ä–µ–º–æ–º –≤–µ–Ω—á—É—Ä–Ω–æ–≥–æ/–∞–Ω–≥–µ–ª—å—Å–∫–æ–≥–æ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è **–º–µ–Ω–µ–µ $2 –º–ª–Ω USD**.
>
> –î–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π, –ø—Ä–µ–≤—ã—à–∞—é—â–∏—Ö —ç—Ç–∏ –ª–∏–º–∏—Ç—ã, –∏–ª–∏ –¥–ª—è —Å–Ω—è—Ç–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π GPL —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏–µ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–π –ª–∏—Ü–µ–Ω–∑–∏–∏. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ–µ–∫—Ç–∞ Marker](https://github.com/VikParuchuri/marker).
